import{r as t,c as e,h as s,a as i}from"./p-cc7ce8c7.js";import{c as n,a as r,b as o,h as c}from"./p-e64f9fcd.js";import{r as l,F as a}from"./p-8617d8eb.js";import{b as h}from"./p-c06b2e12.js";const u=":host{display:block}.sc-address{display:block;position:relative}.sc-address [hidden]{display:none}.sc-address--loading{min-height:230px}.sc-address sc-skeleton{display:block;margin-bottom:1em}.sc-address__control{display:block}.sc-address__control>*{margin-bottom:var(--sc-address-column-spacing, -1px)}.sc-address__columns{display:flex;flex-direction:row;align-items:center;flex-wrap:wrap;justify-content:space-between}.sc-address__columns>*{flex:1;width:50%;margin-right:var(--sc-address-column-spacing, -1px)}.sc-address__columns>*:last-child{margin-right:0}";const d=class{constructor(s){t(this,s);this.scChangeAddress=e(this,"scChangeAddress",7);this.scInputAddress=e(this,"scInputAddress",7);this.address={country:null,city:null,line_1:null,line_2:null,postal_code:null,state:null};this.names={name:"shipping_name",country:"shipping_country",city:"shipping_city",line_1:"shipping_line_1",line_2:"shipping_line_2",postal_code:"shipping_postal_code",state:"shipping_state"};this.placeholders={};this.loading=false;this.disabled=undefined;this.label=undefined;this.showName=undefined;this.showLine2=undefined;this.required=false;this.requireName=false;this.showCity=true;this.showPostal=true;this.regions=undefined;this.countryChoices=n}handleAddressChange(){if(!this.address.country)return;this.setRegions();this.showPostal=r(this.address.country);this.showCity=o(this.address.country);this.scChangeAddress.emit(this.address);this.scInputAddress.emit(this.address)}handleNameChange(){if(this.requireName){this.showName=true}}decodeHtmlEntities(t){var e;return((e=(new DOMParser).parseFromString(t,"text/html"))===null||e===void 0?void 0:e.body.textContent)||t}updateAddress(t){this.address={...this.address,...t}}handleAddressInput(t){this.scInputAddress.emit({...this.address,...t})}clearAddress(){var t;this.address={name:(t=this.address)===null||t===void 0?void 0:t.name,country:null,city:null,line_1:null,line_2:null,postal_code:null,state:null}}setRegions(){if(c(this.address.country)){import("./p-59916e56.js").then((t=>{const e=t===null||t===void 0?void 0:t[this.address.country];this.regions=(e||[]).map((t=>({...t,label:this.decodeHtmlEntities(t.label)})))}))}else{this.regions=[]}}componentWillLoad(){var t;this.handleAddressChange();const e=((t=this.countryChoices.find((t=>t.value===this.address.country)))===null||t===void 0?void 0:t.value)||null;this.updateAddress({country:e});this.handleNameChange()}async reportValidity(){return l(this.el)}render(){var t,e,i,n,r,o,c,l,a,h,u,d,f,p,g,v,m,b,_;return s("div",{class:"sc-address",part:"base"},s("sc-form-control",{label:this.label,exportparts:"label, help-text, form-control",class:"sc-address__control",required:this.required},this.showName&&s("sc-input",{exportparts:"base:input__base, input, form-control, label, help-text",value:(t=this===null||this===void 0?void 0:this.address)===null||t===void 0?void 0:t.name,onScChange:t=>this.updateAddress({name:t.target.value||null}),onScInput:t=>this.handleAddressInput({name:t.target.value||null}),autocomplete:"street-address",placeholder:this.placeholders.name||wp.i18n.__("Name or Company Name","surecart"),name:(e=this.names)===null||e===void 0?void 0:e.name,"squared-bottom":true,disabled:this.disabled,required:this.requireName,"aria-label":this.placeholders.name||wp.i18n.__("Name or Company Name","surecart")}),s("sc-select",{exportparts:"base:select__base, input, form-control, label, help-text, trigger, panel, caret, search__base, search__input, search__form-control, menu__base, spinner__base, empty",part:"name__input",value:(i=this.address)===null||i===void 0?void 0:i.country,onScChange:t=>{this.clearAddress();this.updateAddress({country:t.target.value})},choices:this.countryChoices,autocomplete:"country-name",placeholder:this.placeholders.country||wp.i18n.__("Country","surecart"),name:(n=this.names)===null||n===void 0?void 0:n.country,search:true,unselect:false,"squared-bottom":true,squared:this.showName,disabled:this.disabled,required:this.required,"aria-label":this.placeholders.country||wp.i18n.__("Country","surecart")}),s("sc-input",{exportparts:"base:input__base, input, form-control, label, help-text",value:(r=this===null||this===void 0?void 0:this.address)===null||r===void 0?void 0:r.line_1,onScChange:t=>this.updateAddress({line_1:t.target.value||null}),onScInput:t=>this.handleAddressInput({line_1:t.target.value||null}),autocomplete:"street-address",placeholder:this.placeholders.line_1||wp.i18n.__("Address","surecart"),name:(o=this.names)===null||o===void 0?void 0:o.line_1,squared:true,disabled:this.disabled,required:this.required,"aria-label":this.placeholders.line_1||wp.i18n.__("Address","surecart")}),this.showLine2&&s("sc-input",{exportparts:"base:input__base, input, form-control, label, help-text",value:(c=this===null||this===void 0?void 0:this.address)===null||c===void 0?void 0:c.line_2,onScChange:t=>this.updateAddress({line_2:t.target.value||null}),onScInput:t=>this.handleAddressInput({line_2:t.target.value||null}),autocomplete:"street-address",placeholder:this.placeholders.line_2||wp.i18n.__("Address Line 2","surecart"),name:(l=this.names)===null||l===void 0?void 0:l.line_2,squared:true,disabled:this.disabled,"aria-label":this.placeholders.line_2||wp.i18n.__("Address Line 2","surecart")}),s("div",{class:"sc-address__columns",part:"columns"},this.showCity&&s("sc-input",{exportparts:"base:input__base, input, form-control, label, help-text",placeholder:this.placeholders.city||wp.i18n.__("City","surecart"),name:(a=this.names)===null||a===void 0?void 0:a.city,value:(h=this===null||this===void 0?void 0:this.address)===null||h===void 0?void 0:h.city,onScChange:t=>this.updateAddress({city:t.target.value||null}),onScInput:t=>this.handleAddressInput({city:t.target.value||null}),required:this.required,squared:!!((u=this===null||this===void 0?void 0:this.regions)===null||u===void 0?void 0:u.length),"squared-top":true,disabled:this.disabled,"squared-right":this.showPostal,"aria-label":this.placeholders.city||wp.i18n.__("City","surecart")}),this.showPostal&&s("sc-input",{exportparts:"base:input__base, input, form-control, label, help-text",placeholder:this.placeholders.postal_code||wp.i18n.__("Postal Code/Zip","surecart"),name:(d=this.names)===null||d===void 0?void 0:d.postal_code,onScChange:t=>this.updateAddress({postal_code:t.target.value||null}),onScInput:t=>this.handleAddressInput({postal_code:t.target.value||null}),autocomplete:"postal-code",required:this.required,value:(f=this===null||this===void 0?void 0:this.address)===null||f===void 0?void 0:f.postal_code,squared:!!((p=this===null||this===void 0?void 0:this.regions)===null||p===void 0?void 0:p.length),"squared-top":true,disabled:this.disabled,maxlength:((g=this.address)===null||g===void 0?void 0:g.country)==="US"?5:null,"squared-left":this.showCity,"aria-label":this.placeholders.postal_code||wp.i18n.__("Postal Code/Zip","surecart")})),!!((v=this===null||this===void 0?void 0:this.regions)===null||v===void 0?void 0:v.length)&&!!((m=this===null||this===void 0?void 0:this.address)===null||m===void 0?void 0:m.country)&&s("sc-select",{exportparts:"base:select__base, input, form-control, label, help-text, trigger, panel, caret, search__base, search__input, search__form-control, menu__base, spinner__base, empty",placeholder:this.placeholders.state||wp.i18n.__("State/Province/Region","surecart"),name:(b=this.names)===null||b===void 0?void 0:b.state,autocomplete:"address-level1",value:(_=this===null||this===void 0?void 0:this.address)===null||_===void 0?void 0:_.state,onScChange:t=>{var e;return this.updateAddress({state:t.target.value||((e=t.detail)===null||e===void 0?void 0:e.value)||null})},choices:this.regions,required:this.required,disabled:this.disabled,search:true,"squared-top":true,"aria-label":this.placeholders.state||wp.i18n.__("State/Province/Region","surecart")})),this.loading&&s("sc-block-ui",{exportparts:"base:block-ui, content:block-ui__content"}))}get el(){return i(this)}static get watchers(){return{address:["handleAddressChange"],requireName:["handleNameChange"]}}};d.style=u;function f(t){return!Array.isArray?S(t)==="[object Array]":Array.isArray(t)}const p=1/0;function g(t){if(typeof t=="string"){return t}let e=t+"";return e=="0"&&1/t==-p?"-0":e}function v(t){return t==null?"":g(t)}function m(t){return typeof t==="string"}function b(t){return typeof t==="number"}function _(t){return t===true||t===false||w(t)&&S(t)=="[object Boolean]"}function x(t){return typeof t==="object"}function w(t){return x(t)&&t!==null}function y(t){return t!==undefined&&t!==null}function M(t){return!t.trim().length}function S(t){return t==null?t===undefined?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const C="Extended search is not available";const k="Incorrect 'index' type";const L=t=>`Invalid value for key ${t}`;const A=t=>`Pattern length exceeds max of ${t}.`;const $=t=>`Missing ${t} property in key`;const q=t=>`Property 'weight' in key '${t}' must be a positive integer`;const I=Object.prototype.hasOwnProperty;class N{constructor(t){this._keys=[];this._keyMap={};let e=0;t.forEach((t=>{let s=R(t);e+=s.weight;this._keys.push(s);this._keyMap[s.id]=s;e+=s.weight}));this._keys.forEach((t=>{t.weight/=e}))}get(t){return this._keyMap[t]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function R(t){let e=null;let s=null;let i=null;let n=1;if(m(t)||f(t)){i=t;e=F(t);s=j(t)}else{if(!I.call(t,"name")){throw new Error($("name"))}const r=t.name;i=r;if(I.call(t,"weight")){n=t.weight;if(n<=0){throw new Error(q(r))}}e=F(r);s=j(r)}return{path:e,id:s,weight:n,src:i}}function F(t){return f(t)?t:t.split(".")}function j(t){return f(t)?t.join("."):t}function O(t,e){let s=[];let i=false;const n=(t,e,r)=>{if(!y(t)){return}if(!e[r]){s.push(t)}else{let o=e[r];const c=t[o];if(!y(c)){return}if(r===e.length-1&&(m(c)||b(c)||_(c))){s.push(v(c))}else if(f(c)){i=true;for(let t=0,s=c.length;t<s;t+=1){n(c[t],e,r+1)}}else if(e.length){n(c,e,r+1)}}};n(t,m(e)?e.split("."):e,0);return i?s:s[0]}const E={includeMatches:false,findAllMatches:false,minMatchCharLength:1};const z={isCaseSensitive:false,includeScore:false,keys:[],shouldSort:true,sortFn:(t,e)=>t.score===e.score?t.idx<e.idx?-1:1:t.score<e.score?-1:1};const P={location:0,threshold:.6,distance:100};const W={useExtendedSearch:false,getFn:O,ignoreLocation:false,ignoreFieldNorm:false,fieldNormWeight:1};var D={...z,...E,...P,...W};const T=/[^ ]+/g;function V(t=1,e=3){const s=new Map;const i=Math.pow(10,e);return{get(e){const n=e.match(T).length;if(s.has(n)){return s.get(n)}const r=1/Math.pow(n,.5*t);const o=parseFloat(Math.round(r*i)/i);s.set(n,o);return o},clear(){s.clear()}}}class B{constructor({getFn:t=D.getFn,fieldNormWeight:e=D.fieldNormWeight}={}){this.norm=V(e,3);this.getFn=t;this.isCreated=false;this.setIndexRecords()}setSources(t=[]){this.docs=t}setIndexRecords(t=[]){this.records=t}setKeys(t=[]){this.keys=t;this._keysMap={};t.forEach(((t,e)=>{this._keysMap[t.id]=e}))}create(){if(this.isCreated||!this.docs.length){return}this.isCreated=true;if(m(this.docs[0])){this.docs.forEach(((t,e)=>{this._addString(t,e)}))}else{this.docs.forEach(((t,e)=>{this._addObject(t,e)}))}this.norm.clear()}add(t){const e=this.size();if(m(t)){this._addString(t,e)}else{this._addObject(t,e)}}removeAt(t){this.records.splice(t,1);for(let e=t,s=this.size();e<s;e+=1){this.records[e].i-=1}}getValueForItemAtKeyId(t,e){return t[this._keysMap[e]]}size(){return this.records.length}_addString(t,e){if(!y(t)||M(t)){return}let s={v:t,i:e,n:this.norm.get(t)};this.records.push(s)}_addObject(t,e){let s={i:e,$:{}};this.keys.forEach(((e,i)=>{let n=this.getFn(t,e.path);if(!y(n)){return}if(f(n)){let t=[];const e=[{nestedArrIndex:-1,value:n}];while(e.length){const{nestedArrIndex:s,value:i}=e.pop();if(!y(i)){continue}if(m(i)&&!M(i)){let e={v:i,i:s,n:this.norm.get(i)};t.push(e)}else if(f(i)){i.forEach(((t,s)=>{e.push({nestedArrIndex:s,value:t})}))}else;}s.$[i]=t}else if(!M(n)){let t={v:n,n:this.norm.get(n)};s.$[i]=t}}));this.records.push(s)}toJSON(){return{keys:this.keys,records:this.records}}}function H(t,e,{getFn:s=D.getFn,fieldNormWeight:i=D.fieldNormWeight}={}){const n=new B({getFn:s,fieldNormWeight:i});n.setKeys(t.map(R));n.setSources(e);n.create();return n}function K(t,{getFn:e=D.getFn,fieldNormWeight:s=D.fieldNormWeight}={}){const{keys:i,records:n}=t;const r=new B({getFn:e,fieldNormWeight:s});r.setKeys(i);r.setIndexRecords(n);return r}function U(t,{errors:e=0,currentLocation:s=0,expectedLocation:i=0,distance:n=D.distance,ignoreLocation:r=D.ignoreLocation}={}){const o=e/t.length;if(r){return o}const c=Math.abs(i-s);if(!n){return c?1:o}return o+c/n}function J(t=[],e=D.minMatchCharLength){let s=[];let i=-1;let n=-1;let r=0;for(let o=t.length;r<o;r+=1){let o=t[r];if(o&&i===-1){i=r}else if(!o&&i!==-1){n=r-1;if(n-i+1>=e){s.push([i,n])}i=-1}}if(t[r-1]&&r-i>=e){s.push([i,r-1])}return s}const Z=32;function Q(t,e,s,{location:i=D.location,distance:n=D.distance,threshold:r=D.threshold,findAllMatches:o=D.findAllMatches,minMatchCharLength:c=D.minMatchCharLength,includeMatches:l=D.includeMatches,ignoreLocation:a=D.ignoreLocation}={}){if(e.length>Z){throw new Error(A(Z))}const h=e.length;const u=t.length;const d=Math.max(0,Math.min(i,u));let f=r;let p=d;const g=c>1||l;const v=g?Array(u):[];let m;while((m=t.indexOf(e,p))>-1){let t=U(e,{currentLocation:m,expectedLocation:d,distance:n,ignoreLocation:a});f=Math.min(t,f);p=m+h;if(g){let t=0;while(t<h){v[m+t]=1;t+=1}}}p=-1;let b=[];let _=1;let x=h+u;const w=1<<h-1;for(let i=0;i<h;i+=1){let r=0;let c=x;while(r<c){const t=U(e,{errors:i,currentLocation:d+c,expectedLocation:d,distance:n,ignoreLocation:a});if(t<=f){r=c}else{x=c}c=Math.floor((x-r)/2+r)}x=c;let l=Math.max(1,d-c+1);let m=o?u:Math.min(d+c,u)+h;let y=Array(m+2);y[m+1]=(1<<i)-1;for(let r=m;r>=l;r-=1){let o=r-1;let c=s[t.charAt(o)];if(g){v[o]=+!!c}y[r]=(y[r+1]<<1|1)&c;if(i){y[r]|=(b[r+1]|b[r])<<1|1|b[r+1]}if(y[r]&w){_=U(e,{errors:i,currentLocation:o,expectedLocation:d,distance:n,ignoreLocation:a});if(_<=f){f=_;p=o;if(p<=d){break}l=Math.max(1,2*d-p)}}}const M=U(e,{errors:i+1,currentLocation:d,expectedLocation:d,distance:n,ignoreLocation:a});if(M>f){break}b=y}const y={isMatch:p>=0,score:Math.max(.001,_)};if(g){const t=J(v,c);if(!t.length){y.isMatch=false}else if(l){y.indices=t}}return y}function G(t){let e={};for(let s=0,i=t.length;s<i;s+=1){const n=t.charAt(s);e[n]=(e[n]||0)|1<<i-s-1}return e}class X{constructor(t,{location:e=D.location,threshold:s=D.threshold,distance:i=D.distance,includeMatches:n=D.includeMatches,findAllMatches:r=D.findAllMatches,minMatchCharLength:o=D.minMatchCharLength,isCaseSensitive:c=D.isCaseSensitive,ignoreLocation:l=D.ignoreLocation}={}){this.options={location:e,threshold:s,distance:i,includeMatches:n,findAllMatches:r,minMatchCharLength:o,isCaseSensitive:c,ignoreLocation:l};this.pattern=c?t:t.toLowerCase();this.chunks=[];if(!this.pattern.length){return}const a=(t,e)=>{this.chunks.push({pattern:t,alphabet:G(t),startIndex:e})};const h=this.pattern.length;if(h>Z){let t=0;const e=h%Z;const s=h-e;while(t<s){a(this.pattern.substr(t,Z),t);t+=Z}if(e){const t=h-Z;a(this.pattern.substr(t),t)}}else{a(this.pattern,0)}}searchIn(t){const{isCaseSensitive:e,includeMatches:s}=this.options;if(!e){t=t.toLowerCase()}if(this.pattern===t){let e={isMatch:true,score:0};if(s){e.indices=[[0,t.length-1]]}return e}const{location:i,distance:n,threshold:r,findAllMatches:o,minMatchCharLength:c,ignoreLocation:l}=this.options;let a=[];let h=0;let u=false;this.chunks.forEach((({pattern:e,alphabet:d,startIndex:f})=>{const{isMatch:p,score:g,indices:v}=Q(t,e,d,{location:i+f,distance:n,threshold:r,findAllMatches:o,minMatchCharLength:c,includeMatches:s,ignoreLocation:l});if(p){u=true}h+=g;if(p&&v){a=[...a,...v]}}));let d={isMatch:u,score:u?h/this.chunks.length:1};if(u&&s){d.indices=a}return d}}class Y{constructor(t){this.pattern=t}static isMultiMatch(t){return tt(t,this.multiRegex)}static isSingleMatch(t){return tt(t,this.singleRegex)}search(){}}function tt(t,e){const s=t.match(e);return s?s[1]:null}class et extends Y{constructor(t){super(t)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(t){const e=t===this.pattern;return{isMatch:e,score:e?0:1,indices:[0,this.pattern.length-1]}}}class st extends Y{constructor(t){super(t)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(t){const e=t.indexOf(this.pattern);const s=e===-1;return{isMatch:s,score:s?0:1,indices:[0,t.length-1]}}}class it extends Y{constructor(t){super(t)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(t){const e=t.startsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,this.pattern.length-1]}}}class nt extends Y{constructor(t){super(t)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(t){const e=!t.startsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,t.length-1]}}}class rt extends Y{constructor(t){super(t)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(t){const e=t.endsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[t.length-this.pattern.length,t.length-1]}}}class ot extends Y{constructor(t){super(t)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(t){const e=!t.endsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,t.length-1]}}}class ct extends Y{constructor(t,{location:e=D.location,threshold:s=D.threshold,distance:i=D.distance,includeMatches:n=D.includeMatches,findAllMatches:r=D.findAllMatches,minMatchCharLength:o=D.minMatchCharLength,isCaseSensitive:c=D.isCaseSensitive,ignoreLocation:l=D.ignoreLocation}={}){super(t);this._bitapSearch=new X(t,{location:e,threshold:s,distance:i,includeMatches:n,findAllMatches:r,minMatchCharLength:o,isCaseSensitive:c,ignoreLocation:l})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(t){return this._bitapSearch.searchIn(t)}}class lt extends Y{constructor(t){super(t)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(t){let e=0;let s;const i=[];const n=this.pattern.length;while((s=t.indexOf(this.pattern,e))>-1){e=s+n;i.push([s,e-1])}const r=!!i.length;return{isMatch:r,score:r?0:1,indices:i}}}const at=[et,lt,it,nt,ot,rt,st,ct];const ht=at.length;const ut=/ +(?=([^\"]*\"[^\"]*\")*[^\"]*$)/;const dt="|";function ft(t,e={}){return t.split(dt).map((t=>{let s=t.trim().split(ut).filter((t=>t&&!!t.trim()));let i=[];for(let t=0,n=s.length;t<n;t+=1){const n=s[t];let r=false;let o=-1;while(!r&&++o<ht){const t=at[o];let s=t.isMultiMatch(n);if(s){i.push(new t(s,e));r=true}}if(r){continue}o=-1;while(++o<ht){const t=at[o];let s=t.isSingleMatch(n);if(s){i.push(new t(s,e));break}}}return i}))}const pt=new Set([ct.type,lt.type]);class gt{constructor(t,{isCaseSensitive:e=D.isCaseSensitive,includeMatches:s=D.includeMatches,minMatchCharLength:i=D.minMatchCharLength,ignoreLocation:n=D.ignoreLocation,findAllMatches:r=D.findAllMatches,location:o=D.location,threshold:c=D.threshold,distance:l=D.distance}={}){this.query=null;this.options={isCaseSensitive:e,includeMatches:s,minMatchCharLength:i,findAllMatches:r,ignoreLocation:n,location:o,threshold:c,distance:l};this.pattern=e?t:t.toLowerCase();this.query=ft(this.pattern,this.options)}static condition(t,e){return e.useExtendedSearch}searchIn(t){const e=this.query;if(!e){return{isMatch:false,score:1}}const{includeMatches:s,isCaseSensitive:i}=this.options;t=i?t:t.toLowerCase();let n=0;let r=[];let o=0;for(let i=0,c=e.length;i<c;i+=1){const c=e[i];r.length=0;n=0;for(let e=0,i=c.length;e<i;e+=1){const i=c[e];const{isMatch:l,indices:a,score:h}=i.search(t);if(l){n+=1;o+=h;if(s){const t=i.constructor.type;if(pt.has(t)){r=[...r,...a]}else{r.push(a)}}}else{o=0;n=0;r.length=0;break}}if(n){let t={isMatch:true,score:o/n};if(s){t.indices=r}return t}}return{isMatch:false,score:1}}}const vt=[];function mt(...t){vt.push(...t)}function bt(t,e){for(let s=0,i=vt.length;s<i;s+=1){let i=vt[s];if(i.condition(t,e)){return new i(t,e)}}return new X(t,e)}const _t={AND:"$and",OR:"$or"};const xt={PATH:"$path",PATTERN:"$val"};const wt=t=>!!(t[_t.AND]||t[_t.OR]);const yt=t=>!!t[xt.PATH];const Mt=t=>!f(t)&&x(t)&&!wt(t);const St=t=>({[_t.AND]:Object.keys(t).map((e=>({[e]:t[e]})))});function Ct(t,e,{auto:s=true}={}){const i=t=>{let n=Object.keys(t);const r=yt(t);if(!r&&n.length>1&&!wt(t)){return i(St(t))}if(Mt(t)){const i=r?t[xt.PATH]:n[0];const o=r?t[xt.PATTERN]:t[i];if(!m(o)){throw new Error(L(i))}const c={keyId:j(i),pattern:o};if(s){c.searcher=bt(o,e)}return c}let o={children:[],operator:n[0]};n.forEach((e=>{const s=t[e];if(f(s)){s.forEach((t=>{o.children.push(i(t))}))}}));return o};if(!wt(t)){t=St(t)}return i(t)}function kt(t,{ignoreFieldNorm:e=D.ignoreFieldNorm}){t.forEach((t=>{let s=1;t.matches.forEach((({key:t,norm:i,score:n})=>{const r=t?t.weight:null;s*=Math.pow(n===0&&r?Number.EPSILON:n,(r||1)*(e?1:i))}));t.score=s}))}function Lt(t,e){const s=t.matches;e.matches=[];if(!y(s)){return}s.forEach((t=>{if(!y(t.indices)||!t.indices.length){return}const{indices:s,value:i}=t;let n={indices:s,value:i};if(t.key){n.key=t.key.src}if(t.idx>-1){n.refIndex=t.idx}e.matches.push(n)}))}function At(t,e){e.score=t.score}function $t(t,e,{includeMatches:s=D.includeMatches,includeScore:i=D.includeScore}={}){const n=[];if(s)n.push(Lt);if(i)n.push(At);return t.map((t=>{const{idx:s}=t;const i={item:e[s],refIndex:s};if(n.length){n.forEach((e=>{e(t,i)}))}return i}))}class qt{constructor(t,e={},s){this.options={...D,...e};if(this.options.useExtendedSearch&&!true){throw new Error(C)}this._keyStore=new N(this.options.keys);this.setCollection(t,s)}setCollection(t,e){this._docs=t;if(e&&!(e instanceof B)){throw new Error(k)}this._myIndex=e||H(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(t){if(!y(t)){return}this._docs.push(t);this._myIndex.add(t)}remove(t=(()=>false)){const e=[];for(let s=0,i=this._docs.length;s<i;s+=1){const n=this._docs[s];if(t(n,s)){this.removeAt(s);s-=1;i-=1;e.push(n)}}return e}removeAt(t){this._docs.splice(t,1);this._myIndex.removeAt(t)}getIndex(){return this._myIndex}search(t,{limit:e=-1}={}){const{includeMatches:s,includeScore:i,shouldSort:n,sortFn:r,ignoreFieldNorm:o}=this.options;let c=m(t)?m(this._docs[0])?this._searchStringList(t):this._searchObjectList(t):this._searchLogical(t);kt(c,{ignoreFieldNorm:o});if(n){c.sort(r)}if(b(e)&&e>-1){c=c.slice(0,e)}return $t(c,this._docs,{includeMatches:s,includeScore:i})}_searchStringList(t){const e=bt(t,this.options);const{records:s}=this._myIndex;const i=[];s.forEach((({v:t,i:s,n})=>{if(!y(t)){return}const{isMatch:r,score:o,indices:c}=e.searchIn(t);if(r){i.push({item:t,idx:s,matches:[{score:o,value:t,norm:n,indices:c}]})}}));return i}_searchLogical(t){const e=Ct(t,this.options);const s=(t,e,i)=>{if(!t.children){const{keyId:s,searcher:n}=t;const r=this._findMatches({key:this._keyStore.get(s),value:this._myIndex.getValueForItemAtKeyId(e,s),searcher:n});if(r&&r.length){return[{idx:i,item:e,matches:r}]}return[]}const n=[];for(let r=0,o=t.children.length;r<o;r+=1){const o=t.children[r];const c=s(o,e,i);if(c.length){n.push(...c)}else if(t.operator===_t.AND){return[]}}return n};const i=this._myIndex.records;const n={};const r=[];i.forEach((({$:t,i})=>{if(y(t)){let o=s(e,t,i);if(o.length){if(!n[i]){n[i]={idx:i,item:t,matches:[]};r.push(n[i])}o.forEach((({matches:t})=>{n[i].matches.push(...t)}))}}}));return r}_searchObjectList(t){const e=bt(t,this.options);const{keys:s,records:i}=this._myIndex;const n=[];i.forEach((({$:t,i})=>{if(!y(t)){return}let r=[];s.forEach(((s,i)=>{r.push(...this._findMatches({key:s,value:t[i],searcher:e}))}));if(r.length){n.push({idx:i,item:t,matches:r})}}));return n}_findMatches({key:t,value:e,searcher:s}){if(!y(e)){return[]}let i=[];if(f(e)){e.forEach((({v:e,i:n,n:r})=>{if(!y(e)){return}const{isMatch:o,score:c,indices:l}=s.searchIn(e);if(o){i.push({score:c,key:t,value:e,idx:n,norm:r,indices:l})}}))}else{const{v:n,n:r}=e;const{isMatch:o,score:c,indices:l}=s.searchIn(n);if(o){i.push({score:c,key:t,value:n,norm:r,indices:l})}}return i}}qt.version="6.5.3";qt.createIndex=H;qt.parseIndex=K;qt.config=D;{qt.parseQuery=Ct}{mt(gt)}const It=":host{display:block;--focus-ring:0 0 0 var(--sc-focus-ring-width) var(--sc-focus-ring-color-primary)}.search{margin:var(--sc-spacing-x-small) var(--sc-spacing-x-small) 0 var(--sc-spacing-x-small)}.loading{text-align:center;margin:var(--sc-spacing-small)}.select{font-family:var(--sc-input-font-family);font-weight:var(--sc-font-weight-normal)}sc-dropdown{display:block}.trigger{overflow:hidden;box-sizing:border-box;width:100%;display:flex;align-items:center;justify-content:space-between;width:100%;border-style:solid;border-width:var(--sc-input-border-width);background-color:var(--sc-select-background-color, var(--sc-color-white));border-color:var(--sc-select-border-color, var(--sc-color-gray-300));color:var(--sc-input-color);text-decoration:none;user-select:none;white-space:nowrap;vertical-align:middle;padding:0;transition:var(--sc-input-transition, var(--sc-transition-medium)) background-color, var(--sc-input-transition, var(--sc-transition-medium)) color, var(--sc-input-transition, var(--sc-transition-medium)) border, var(--sc-input-transition, var(--sc-transition-medium)) box-shadow;cursor:inherit;box-shadow:var(--sc-shadow-small);font-size:var(--sc-button-font-size-medium);min-height:var(--sc-input-height-medium);line-height:calc(var(--sc-input-height-medium) - var(--sc-input-border-width) * 2);border-radius:var(--sc-input-border-radius-medium);padding:0 var(--sc-spacing-small)}.trigger svg{display:block;width:1em;height:1em}.select.select--focused:not(.select--disabled) .trigger{background-color:var(--sc-input-background-color-focus);border-color:var(--sc-input-border-color-focus);box-shadow:var(--focus-ring);z-index:2}.select--disabled{cursor:not-allowed}.select--disabled sc-dropdown{opacity:0.65}.select__value{overflow:hidden;text-overflow:ellipsis}.select__empty{text-align:center;margin:var(--sc-spacing-small);color:var(--sc-color-gray-400)}.select--placeholder .trigger{color:var(--sc-input-placeholder-color)}.select__hidden-input{position:absolute;opacity:0;padding:0px;margin:0px;pointer-events:none;width:0}.select__suffix-description,.select__description{font-size:var(--sc-input-help-text-font-size-medium);opacity:0.65}.select__caret{transition:transform 0.25s ease;line-height:0}.select--is-open .select__caret{transform:rotate(180deg)}.select--squared .trigger{border-radius:0}.select--squared-top .trigger{border-top-left-radius:0;border-top-right-radius:0}.select--squared-bottom .trigger{border-bottom-left-radius:0;border-bottom-right-radius:0}.select--squared-left .trigger{border-top-left-radius:0;border-bottom-left-radius:0}.select--squared-right .trigger{border-top-right-radius:0;border-bottom-right-radius:0}.choice__icon--image{width:18px;height:18px;object-fit:contain}sc-menu-item.is-unavailable{--sc-menu-item-color:var(--sc-color-gray-500)}";let Nt=0;let Rt=0;let Ft="";const jt=class{constructor(s){t(this,s);this.scSearch=e(this,"scSearch",7);this.scOpen=e(this,"scOpen",7);this.scClose=e(this,"scClose",7);this.scBlur=e(this,"scBlur",7);this.scFocus=e(this,"scFocus",7);this.scChange=e(this,"scChange",7);this.scScrollEnd=e(this,"scScrollEnd",7);this.inputId=`select-${++Nt}`;this.helpId=`select-help-text-${Nt}`;this.labelId=`select-label-${Nt}`;this.autocomplete=undefined;this.placeholder="";this.searchPlaceholder="";this.value="";this.choices=[];this.unselect=true;this.required=undefined;this.loading=undefined;this.search=undefined;this.closeOnSelect=true;this.name=undefined;this.help=undefined;this.label=undefined;this.size="medium";this.position="bottom-right";this.placement="bottom-start";this.invalid=false;this.open=undefined;this.disabled=undefined;this.showParentLabel=true;this.hoist=false;this.squared=undefined;this.squaredBottom=undefined;this.squaredTop=undefined;this.squaredLeft=undefined;this.squaredRight=undefined;this.hasFocus=false;this.searchTerm="";this.filteredChoices=[]}handleShow(){this.open=true;setTimeout((()=>{this.searchInput&&this.searchInput.triggerFocus()}),50)}handleHide(){this.open=false;Rt=0;this.scClose.emit()}handleBlur(){this.hasFocus=false;this.scBlur.emit()}handleFocus(){this.hasFocus=true;this.el.focus();this.scFocus.emit()}displayValue(){var t;if(!this.value)return false;let e=this.choices.find((t=>t.value==this.value));let s="";if(!e){if(this.showParentLabel){s=(t=this.choices.find((t=>{var e,s;return(s=(e=t===null||t===void 0?void 0:t.choices)===null||e===void 0?void 0:e.some)===null||s===void 0?void 0:s.call(e,(t=>t.value===this.value))})))===null||t===void 0?void 0:t.label}const i=(this.choices||[]).map((t=>t.choices)).flat();e=i.find((t=>(t===null||t===void 0?void 0:t.value)==this.value))}if(e){return`${s?s+" — ":""}${e===null||e===void 0?void 0:e.label}`}return false}isChecked({value:t,checked:e=false}){if(e){return true}return!!t&&this.value===t}async setCustomValidity(t){this.input.setCustomValidity(t);this.invalid=!this.input.checkValidity()}async reportValidity(){return this.input.reportValidity()}handleQuery(t){this.searchTerm=t.target.value;this.scSearch.emit(this.searchTerm)}handleSelect(t){const{value:e}=t;if(this.value===e&&this.unselect){this.value=""}else{this.value=e}if(this.closeOnSelect){this.searchTerm=""}this.scChange.emit(t)}handleSearchChange(){const t=new qt(this.choices,{keys:["value","label"]});if(this.searchTerm){const e=t.search(this.searchTerm);this.filteredChoices=e.map((t=>t.item))}else{this.filteredChoices=this.choices}}handleValueChange(){if(this.input){this.invalid=!this.input.checkValidity()}}handleOpenChange(){if(this.open){this.scOpen.emit();this.searchInput&&this.searchInput.triggerFocus()}else{this.scClose.emit()}}handleMenuScroll(t){const e=t.target.scrollTop;const s=t.target.scrollHeight;const i=t.target.offsetHeight;const n=s-i;if(n-e<5)this.scScrollEnd.emit()}componentWillLoad(){this.handleSearchChange()}componentDidLoad(){this.formController=new a(this.el).addFormData();if(this.open){this.searchInput&&this.searchInput.triggerFocus()}}getItems(){return[...this.el.shadowRoot.querySelectorAll("sc-menu-item")]}handleKeyDown(t){var e,s;const i=t.target;const n=this.getItems();if(i.tagName.toLowerCase()==="sc-tag"){return}if(t.key==="Tab"){if(this.open){this.handleHide()}return}if(["ArrowDown","ArrowUp"].includes(t.key)){t.preventDefault();if(!this.open){this.handleShow()}if(t.key==="ArrowDown"){if(Ft=="up"){Rt=Rt+2}if(Rt>n.length-1){Rt=0}n[Rt].setFocus();Ft="down";Rt++;return}if(t.key==="ArrowUp"){if(Ft=="down"){Rt=Rt-2}if(Rt<0){Rt=n.length-1}n[Rt].setFocus();Ft="up";Rt--;return}}if(t.key==="Escape"){if(this.open){this.input.focus();this.handleHide()}return}if(t.key==="Enter"){if(this.open){(s=(e=n[Rt-1])===null||e===void 0?void 0:e.click)===null||s===void 0?void 0:s.call(e);this.handleHide();this.input.focus()}else{this.handleShow()}}if(t.ctrlKey||t.metaKey){return}if(!this.open&&this.hasFocus&&t.key.length===1){this.handleShow()}}disconnectedCallback(){var t;(t=this.formController)===null||t===void 0?void 0:t.removeFormData()}renderIcon(t){if(h(t)){return s("img",{src:t,alt:"icon",slot:"prefix",class:"choice__icon--image"})}return s("sc-icon",{name:t,slot:"prefix",class:"choice__icon"})}renderItem(t,e){var i;if((i=t===null||t===void 0?void 0:t.choices)===null||i===void 0?void 0:i.length){return s("sc-menu-label",{key:e},t.label)}return s("sc-menu-item",{class:{"is-unavailable":t===null||t===void 0?void 0:t.unavailable},key:e,checked:this.isChecked(t),value:t===null||t===void 0?void 0:t.value,onClick:()=>!t.disabled&&this.handleSelect(t),onKeyDown:e=>{if((e.key==="Enter"||e.key===" ")&&!t.disabled){e.preventDefault();e.stopImmediatePropagation();this.handleSelect(t)}},disabled:t.disabled,"aria-label":t.label,"aria-selected":this.isChecked(t)?"true":"false",role:"option"},t.label,!!(t===null||t===void 0?void 0:t.description)&&s("div",{class:"select__description"},t===null||t===void 0?void 0:t.description),s("div",{slot:"suffix"},t===null||t===void 0?void 0:t.suffix," ",!!(t===null||t===void 0?void 0:t.suffixDescription)&&s("div",{class:"select__suffix-description"},t===null||t===void 0?void 0:t.suffixDescription)),!!(t===null||t===void 0?void 0:t.icon)&&this.renderIcon(t.icon))}render(){var t;return s("div",{part:"base",class:{select:true,"select--placeholder":!this.value,"select--focused":this.hasFocus,"select--is-open":!!this.open,"select--disabled":this.disabled,"select--has-choices":!!((t=this===null||this===void 0?void 0:this.choices)===null||t===void 0?void 0:t.length),"select--squared":this.squared,"select--squared-bottom":this.squaredBottom,"select--squared-top":this.squaredTop,"select--squared-left":this.squaredLeft,"select--squared-right":this.squaredRight}},s("sc-form-control",{exportparts:"label, help-text, form-control",size:this.size,required:this.required,label:this.label,help:this.help,inputId:this.inputId,helpId:this.helpId,labelId:this.labelId,name:this.name},s("input",{class:"select__hidden-input",name:this.name,ref:t=>this.input=t,value:this.value,required:this.required,disabled:this.disabled,"aria-hidden":"true","aria-label":this.displayValue()||this.label||this.placeholder,onBlur:()=>this.handleBlur(),onFocus:()=>this.handleFocus()}),s("sc-dropdown",{exportparts:"trigger, panel",disabled:this.disabled,open:this.open,closeOnSelect:this.closeOnSelect,position:this.position,placement:this.placement,hoist:this.hoist,style:{"--panel-width":"100%"},onScShow:()=>this.handleShow(),onScHide:()=>this.handleHide(),role:"select","aria-open":this.open?"true":"false"},s("slot",{name:"trigger",slot:"trigger"},s("div",{class:"trigger",role:"button",tabIndex:-1,onFocus:()=>this.handleFocus(),onBlur:()=>this.handleBlur()},s("div",{class:"select__value"},s("slot",null,this.displayValue()||this.placeholder||wp.i18n.__("Select...","surecart"))),s("sc-icon",{exportparts:"base:caret",class:"select__caret",name:"chevron-down"}))),this.search&&s("sc-input",{exportparts:"base:search__base, input:search__input, form-control:search__form-control",placeholder:this.searchPlaceholder||wp.i18n.__("Search...","surecart"),onScInput:t=>this.handleQuery(t),class:"search",clearable:true,part:"search",value:this.searchTerm,ref:t=>this.searchInput=t,"aria-label":wp.i18n.__("Type to search","surecart"),onKeyDown:t=>t.stopPropagation()},this.loading&&s("sc-spinner",{exportparts:"base:spinner__base",style:{"--spinner-size":"0.5em"},slot:"suffix"})),s("sc-menu",{style:{maxHeight:"210px",overflow:"auto"},exportparts:"base:menu__base",onScroll:t=>this.handleMenuScroll(t),"aria-multiselectable":"false"},s("slot",{name:"prefix"}),(this.filteredChoices||[]).map(((t,e)=>[this.renderItem(t,e),(t.choices||[]).map((t=>this.renderItem(t,e)))])),this.loading&&s("div",{class:"loading"},s("sc-spinner",{exportparts:"base:spinner__base"})),!this.loading&&!this.filteredChoices.length&&s("div",{class:"select__empty",part:"empty"},wp.i18n.__("Nothing Found","surecart")),s("slot",{name:"suffix"})))))}get el(){return i(this)}static get watchers(){return{searchTerm:["handleSearchChange"],choices:["handleSearchChange"],value:["handleValueChange"],open:["handleOpenChange"]}}};jt.style=It;export{d as sc_address,jt as sc_select};
//# sourceMappingURL=p-69f2e7cc.entry.js.map